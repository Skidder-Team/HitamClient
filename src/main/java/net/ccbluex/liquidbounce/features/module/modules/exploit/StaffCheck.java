package net.ccbluex.liquidbounce.features.module.modules.exploit;

import net.ccbluex.liquidbounce.event.EventTarget;
import net.ccbluex.liquidbounce.event.PacketEvent;
import net.ccbluex.liquidbounce.event.UpdateEvent;
import net.ccbluex.liquidbounce.features.module.*;
import net.ccbluex.liquidbounce.utils.ClientUtils;
import net.ccbluex.liquidbounce.utils.timer.MSTimer;
import net.minecraft.network.Packet;
import net.minecraft.network.play.client.C01PacketChatMessage;
import net.minecraft.network.play.server.S02PacketChat;

import java.util.concurrent.LinkedBlockingQueue;


@ModuleInfo(name = "StaffCheck", category = ModuleCategory.EXPLOIT)
public class StaffCheck extends Module  {

    private final MSTimer timer = new MSTimer();
    private final String[] staffs = new String[]{"Jiternos", "FacedApollo", "BadAccuracyID", "LyraMS", "iBapL", "SpotifyProfile", "xXAyamBetutuXx", "ARVIN1308", "_Rzz", "BukanNezon", "BlazePxly", "Afif87123", "Xylanneal", "KimRokSoo", "JoseMarcellio", "ZenthicMC", "GazorYT", "DaozaBoy", "FayBoy", "rajaopak", "Funaa", "GeraldiNP", "Isnic", "Cyclize", "SassyLords", "mfik", "RekinZ", "Rynqu", "Ghifary", "Lucents", "sepensins", "MrRanZler", "Aeterna_", "ArianShev", "CreEzte", "E4_Exist", "Enter_Wisely", "TerraDirtz", "prqbu", "Pvpiify", "Prisoner", "Contradictor", "_PedPed_", "Miichin", "Atticuss_Rhodes", "Nerozvox", "Pulpen", "Supramen", "ItzStormz", "ChromaaXD"};
    private final LinkedBlockingQueue<String> res = new LinkedBlockingQueue<>();

    public void onEnable() {
        res.clear();
        timer.reset();

        ClientUtils.INSTANCE.displayChatMessage("§eChecking §b" + staffs.length + " §estaff members...");
        String[] var1 = staffs;
        int var2 = 0;

        while(var2 < var1.length) {
            String i = var1[var2];
            ++var2;
            mc.getNetHandler().addToSendQueue(new C01PacketChatMessage("/p " + i));
        }
    }

    public void onDisable() {
        ClientUtils.INSTANCE.displayChatMessage("§eFound §b" + res.size() + " §estaff members possibly online.");

        for (final String result : res) {
            ClientUtils.INSTANCE.displayChatMessage("§b" + result);
        }
    }

    @EventTarget
    public final void onUpdate(UpdateEvent event) {
        if (timer.hasTimePassed(1000L)) {
            setState(false);
        }
    }

    @EventTarget
    public final void onPacket(PacketEvent event) {
        Packet<?> packet = event.getPacket();
        if (packet instanceof S02PacketChat) {
            S02PacketChat packetChat = (S02PacketChat) packet;
            String text = packetChat.getChatComponent().getUnformattedText().toLowerCase();

            String[] var9 = this.staffs;
            int var10 = 0;

            while(var10 < var9.length) {
                String n = var9[var10];
                ++var10;
                if (text.contains(n.toLowerCase())) {
                    res.add(n);
                }
            }
        }

    }
}